<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Base64 JSON Decoder</title>
</head>
<body onload="decodeBase64ToJson()">

    <h2>Base64 JSON Decoder</h2>

    <!-- Hidden input to receive base64 from FastAPI -->
    <input type="hidden" id="email_data" value="{{ email_data }}">

    <!-- Optional manual trigger -->
    <button onclick="decodeBase64ToJson()">Decode Again</button>

    <!-- Display result -->
    <pre id="output">Waiting to decode...</pre>

    <!-- Your embedded JavaScript -->
    <script>
        function decodeBase64ToJson() {
            const encoded = document.getElementById("email_data").value;
            console.log("Encoded:", encoded);

            try {
                const base64Decoded = atob(decodeURIComponent(encoded)); // safer
                console.log("Decoded string:", base64Decoded);

                const json = JSON.parse(base64Decoded);
                console.log("Parsed JSON:", json);

                document.getElementById("output").innerText = JSON.stringify(json, null, 2);
            } catch (e) {
                console.error("Error:", e);
                document.getElementById("output").innerText = "Failed to decode/parse JSON";
            }
        }
    </script>
</body>
</html>
